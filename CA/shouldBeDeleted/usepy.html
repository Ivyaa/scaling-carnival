<!doctype html>
<html lang="en">
    <head>
        <!-- Required meta tags -->
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

		<script src="../script/preLoad.js"></script>
        <script src="../script/time.js"></script>

        <style></style>
   
    </head>
    <body>    
      
        <!--obs input-->
        <main>
            <form class="container-fluid">
                <div class="form-row px-4 col-12">  
                    <div class="form-group col-md-5 mt-3">
                        <label for="time" class="mx-2">Input Time : </label>
                        <input type="datetime-local" name="time" id="time" class="form-control col-md-8" required>
                    </div>
                    <div class="form-group col-md-5 mt-3">
                        <label for="observer" class="mx-2">Input person : </label>
                        <input type="text" name="observer" id="observer" class="form-control col-md-8" readonly>
                    </div>
                </div>
                
                </div>
                <div class="form-row px-4 col-12">
                    <div class="form-group col-md-12 mt-3">
                        <label for="comment" class="mx-2">memo : </label>
                        <textarea name="comment" id="comment" class="form-control" rows="3"></textarea>
                    </div>
                </div>
				<button type="button" id="btn_submit" class="btn btn-primary mx-3 mt-3 float-right">enter</button>
            </form>
        </main>
        
        <script type="text/javascript">
            //fill the present time
            $(document).ready(function(){
                $("#btn_submit").click(function(){
                        let url = 'http://140.115.35.136:8044/cgi-bin/test.py';
                        let data = {time: $("#time").val().replace('T',' '),
                                    observer: $("#observer").val(),
                                    comment: $("#comment").val()};
                        let dataSend = Object.keys(data).map(function (keyName) {
                                        return escape(keyName) + '=' + escape(data[keyName])
                        }).join('&');
                        //let dataSend = encodeURI(JSON.stringify(data))

                        fetch(url, {
                            method: 'POST',
                            body: dataSend,
                            headers:{
                                'Content-Type': 'application/x-www-form-urlencoded; charset=utf-8'
                            }
                        }).then(res => res.text())
                        .catch(error => console.error('Error:', error))
                        .then(response => {
                            console.log(response);
                            alert(response);
                        })
                    });
            });
        </script>
    </body>
</html>